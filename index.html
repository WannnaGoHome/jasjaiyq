<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <title data-i18n="app.title">–ö–≤–∏–∑-–∏–≥—Ä–∞</title>
        <link rel="stylesheet" href="styles.css"/>
        <script src="https://telegram.org/js/telegram-web-app.js"></script>
    </head>
    <body>
        <div class="app-container">

            <!-- 1) –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø -->
            <div id="state-registration" class="state">
            <div class="container">
                <h1 data-i18n="app.title">üéØ –ö–≤–∏–∑-–∏–≥—Ä–∞</h1>
                <!-- <p data-i18n="registration.subtitle"> –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –¥–ª—è —É—á–∞—Å—Ç–∏—è </p> -->
                <form id="registration-form">
                    <div class="name-fields">
                        <input
                            type="text"
                            id="firstname-input"
                            name="first_name"
                            maxlength="40"
                            required
                            placeholder="Enter First name"
                            data-i18n-placeholder="registration.firstname_ph" />
                        <input
                            type="text"
                            id="lastname-input"
                            name="last_name"
                            maxlength="40"
                            required
                            placeholder="Enter Last name"
                            data-i18n-placeholder="registration.lastname_ph" />
                        <input
                            type="text"
                            id="nickname-input"
                            name="nickname"
                            maxlength="20"
                            required
                            placeholder="Enter nickname"
                            data-i18n-placeholder="registration.nickname_ph" />
                    </div>
                    <div class="lang-select">
                        <h3 data-i18n="registration.choose_lang">–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫ / Select language</h3>
                        <div class="lang-options">
                            <label class="lang-option">
                                <input type="radio" name="lang" value="kk" id="lang-kk" />
                                <span data-i18n="registration.lang_kk">“ö–∞–∑–∞“õ —Ç—ñ–ª—ñ</span>
                            </label>
                            <label class="lang-option">
                                <input type="radio" name="lang" value="ru" id="lang-ru" checked />
                                <span data-i18n="registration.lang_ru">–†—É—Å—Å–∫–∏–π</span>
                            </label>
                            <label class="lang-option">
                                <input type="radio" name="lang" value="en" id="lang-en" />
                                <span data-i18n="registration.lang_en">English</span>
                            </label>
                        </div>
                    </div>
                    <button type="submit" id="register-btn" data-i18n="registration.join_btn"> –£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å! </button>
                </form>
                <div id="registration-error" class="hidden error-message"></div>
            </div>
            </div>

            <!-- 2) –û–ñ–ò–î–ê–ù–ò–ï –°–¢–ê–†–¢–ê -->
            <div id="state-waiting" class="state hidden">
            <div class="container">
                <div class="icon">‚è≥</div>
                <h1 data-i18n="waiting.title">–û–∂–∏–¥–∞–µ–º –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã</h1>

                <p>
                <span data-i18n="waiting.nickname_label">–í–∞—à –Ω–∏–∫–Ω–µ–π–º:</span>
                <strong id="waiting-nickname"></strong>
                </p>

                <p data-i18n="waiting.wait_text">
                –ö–∞–∫ —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω –∑–∞–ø—É—Å—Ç–∏—Ç –∏–≥—Ä—É, –∑–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å. –û—Å—Ç–∞–≤–∞–π—Ç–µ—Å—å –Ω–∞ —Å–≤—è–∑–∏!
                </p>

                <button
                onclick="showLanguagePicker()"
                class="btn btn-outline"
                style="margin-top: 2rem;"
                data-i18n="common.logout"
                >
                –ü–æ–º–µ–Ω—è—Ç—å —è–∑—ã–∫
                </button>
                <div class="loader"></div>
            </div>
            </div>

            <!-- 2.1) –û–ñ–ò–î–ê–ù–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–û–í -->
            <div id="state-waiting-results" class="state hidden">
            <div class="container">
                <div class="icon">‚è≥</div>
                <h1 data-i18n="waiting_results.title">–û–∂–∏–¥–∞–µ–º‚Ä¶</h1>
                <p>
                <span data-i18n="waiting_results.nickname_label">–í–∞—à –Ω–∏–∫–Ω–µ–π–º:</span>
                <strong id="waiting-nickname"></strong>
                </p>
                <p data-i18n="waiting_results.text">
                –ö–∞–∫ —Ç–æ–ª—å–∫–æ –∏–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è, –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –ø–æ–¥—Å—á—ë—Ç –æ—á–∫–æ–≤ –∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —ç—Ç–æ–≥–æ —ç—Ç–∞–ø–∞!
                </p>
                <button
                onclick="showLanguagePicker()"
                class="btn btn-outline"
                style="margin-top: 2rem;"
                data-i18n="common.logout" >
                –ü–æ–º–µ–Ω—è—Ç—å —è–∑—ã–∫
                </button>
                <div class="loader"></div>
            </div>
            </div>

            <!-- 3) –ò–ì–†–ê ‚Äî –û–¢–ö–†–´–¢–´–ï –û–¢–í–ï–¢–´ -->
            <div id="state-game-open" class="state hidden">
            <div class="container">
                <div class="question-header">     
                <div class="quiz-title" id="quiz-title"></div>
                <div class="qh-row">
                    <div class="timer-badge panel">
                    <div id="question-timer" class="timer">00:16</div>
                </div>
                <div id="question-progress" data-i18n="game.question_of">
                    –í–æ–ø—Ä–æ—Å <span id="current-q">1</span>/<span id="total-qs">5</span>
                </div>
                </div>
                </div>
                <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                </div>
                <div class="question-block panel question-card">
                <h2 id="question-text" data-i18n="game.loading_question">–¢–µ–∫—Å—Ç —Ç–µ–∫—É—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...</h2>
                </div>
                <div class="hr-soft"></div>
                <div class="answer-block panel answer-card">
                <textarea
                    id="answer-textarea"
                    rows="5"
                    placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –æ—Ç–≤–µ—Ç –∑–¥–µ—Å—å..."
                    data-i18n-placeholder="game.answer_ph"></textarea>
                <div class="actions">
                    <button id="submit-answer-btn" disabled data-i18n="game.submit">
                    –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç
                    </button>
                    <div id="answer-status"></div>
                </div>
                </div>
            </div>
            </div>
            
            <!-- 3.1) –ò–ì–†–ê ‚Äî –í–ê–†–ò–ê–ù–¢–´ –û–¢–í–ï–¢–û–í -->
            <div id="state-game" class="state hidden">
            <div class="container">
                <div class="question-header">
                    
                <div class="quiz-title" id="quiz-title"></div>
                <div class="qh-row">
                    <div class="timer-badge panel">
                        <div id="question-timer" class="timer">00:16</div>
                    </div>
                    <div id="question-progress" data-i18n="game.question_of">
                        –í–æ–ø—Ä–æ—Å <span id="current-q">1</span>/<span id="total-qs">5</span>
                    </div>
                    </div>
                </div>
                <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                </div>
                <div class="question-block panel question-card">
                <h2 id="question-text" data-i18n="game.loading_question">–¢–µ–∫—Å—Ç —Ç–µ–∫—É—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...</h2>
                </div>
                <div id="options" class="answers-grid"></div>
            </div>
            </div>

            <!-- 3.2) –ò–ì–†–ê ‚Äî –í–ê–†–ò–ê–ù–¢–´ –û–¢–í–ï–¢–û–í –° –ö–ê–†–¢–ò–ù–ö–û–ô -->
            <div id="state-game-image" class="state hidden">
                <div class="container">
                    <div class="question-header"> 
                        <div class="quiz-title" id="quiz-title"></div>
                        <div class="qh-row">
                            <div class="timer-badge panel">
                                <div id="question-timer" class="timer">00:25</div>
                            </div>
                            <div id="question-progress" data-i18n="game.question_of">
                                –í–æ–ø—Ä–æ—Å <span id="current-q">1</span>/<span id="total-qs">5</span>
                            </div>
                        </div>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill"></div>
                        </div>
                    </div>
                    <div class="question-block panel question-card">
                        <h2 id="question-text">–£–≥–∞–¥–∞–π, –∫–æ—Ç–æ—Ä–∞—è –∏–∑ –∫–∞—Ä—Ç–∏–Ω–æ–∫ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞.</h2>
                    </div>
                    <div class="single-image-container">
                    </div>
                    <div id="options" class="answers-grid">
                    </div>
                </div>
            </div>

            <!-- 4) –ú–ï–ñ–î–£ –í–û–ü–†–û–°–ê–ú–ò -->
            <div id="state-between" class="state hidden">
            <div class="container">
                <div class="icon">‚úî</div>
                <h2 data-i18n="between.title">–û—Ç–≤–µ—Ç –ø—Ä–∏–Ω—è—Ç!</h2>
                <p data-i18n="between.next_in">
                –°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å –ø–æ—è–≤–∏—Ç—Å—è —á–µ—Ä–µ–∑ <span id="between-timer">5</span> —Å–µ–∫—É–Ω–¥...
                </p>
                <p data-i18n="between.stay_tuned">
                –û—Å—Ç–∞–≤–∞–π—Ç–µ—Å—å —Å –Ω–∞–º–∏! –í—ã —Å—Ç–∞–ª–∏ –Ω–∞ —à–∞–≥ –±–ª–∏–∂–µ –∫ –ø–æ–±–µ–¥–µ...
                </p>
            </div>
            </div>

            <!-- 5) –§–ò–ù–ò–® -->
            <div id="state-finished" class="state hidden">
            <div class="container">
                <div class="icon">üèÅ</div>
                <h1 data-i18n="finished.title">–ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h1>
                <p data-i18n="finished.thanks">
                –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à–∏ –æ—Ç–≤–µ—Ç—ã –∏ —É—á–∞—Å—Ç–∏–µ!
                </p>
                <p data-i18n="finished.processing">
                –°–µ–π—á–∞—Å –Ω–∞—à –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã. –ò—Ç–æ–≥–∏ –∏ —Å–ø–∏—Å–æ–∫ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –±—É–¥—É—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω—ã –∑–¥–µ—Å—å –ø–æ–∑–∂–µ.
                </p>
            </div>
            </div>

            <!-- 6) –ü–û–ë–ï–î–ò–¢–ï–õ–¨ -->
            <div id="state-winner" class="state hidden">
                <div class="container">
                    <div class="icon">üèÜ</div>
                    <h1 data-i18n="winner.title">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h1>
                    <p data-i18n="winner.text">
                    –í–∞—à–∏ –æ—Ç–≤–µ—Ç—ã –±—ã–ª–∏ –æ–¥–Ω–∏–º–∏ –∏–∑ —Å–∞–º—ã—Ö –ª—É—á—à–∏—Ö! –í—ã –≤–æ—à–ª–∏ –≤ —á–∏—Å–ª–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π!
                    </p>
                    <div class="prize-info">
                        <h3 data-i18n="winner.prize_title">–í–∞—à –ø—Ä–∏–∑:</h3>
                        <p data-i18n="winner.prize_text">
                            –ü–æ–¥–æ–π–¥–∏—Ç–µ –∫ —Å—Ç–æ–π–∫–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–æ–≤ –Ω–∞ –ø–µ—Ä–≤–æ–º —ç—Ç–∞–∂–µ –∏ –Ω–∞–∑–æ–≤–∏—Ç–µ —Å–≤–æ–π –Ω–∏–∫–Ω–µ–π–º
                            <strong id="winner-nickname"></strong> –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞—Å–ª—É–∂–µ–Ω–Ω–æ–π –Ω–∞–≥—Ä–∞–¥—ã.
                        </p>
                    </div>
                    <p data-i18n="winner.thanks_again">–ï—â–µ —Ä–∞–∑ —Å–ø–∞—Å–∏–±–æ –∑–∞ —É—á–∞—Å—Ç–∏–µ!</p>
                </div>
            </div>

            <!-- 7) –í–ò–î–ï–û –ö–û–ù–ï–¶ –í–ò–ö–¢–û–†–ò–ù–´ -->
            <!-- <div id="countdown-overlay" class="hidden">
                <video
                    id="countdown-video"
                    src="./gamecount.mp4"
                    preload="auto"
                    playsinline
                    webkit-playsinline
                    muted
                ></video>
            </div> -->
        </div>

        <audio id="sfx-bg"      src="./sfx/background.mp3" preload="auto" loop></audio>
        <audio id="sfx-correct" src="./sfx/correct.mp3" preload="auto"></audio>
        <audio id="sfx-wrong"   src="./sfx/wrong.mp3"   preload="auto"></audio>
        <script src="api-client.js"></script>
        <script src="script.js"></script>
    </body>
</html>